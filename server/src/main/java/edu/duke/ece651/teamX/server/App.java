/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package edu.duke.ece651.teamX.server;
import edu.duke.ece651.teamX.shared.*;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;

public class App {
  //!!!! Just for testing!!!!
  public static void main(String[] args) throws IOException, ClassNotFoundException {
    Communicate communicate = new Communicate();
    ServerSocket ss = new ServerSocket(4444);
    int try_num = 3;
    Game game = new Game(try_num, 20);
    PlayerName namer = new ColorPlayerName();
    //Connect to players (Might need to be done in Game)
    ArrayList<Socket> socket_list = new ArrayList<Socket>();
    for (int i = 0; i < try_num; i++) {
      Socket pSocket = ss.accept();
      socket_list.add(pSocket);
      game.createPlayer(pSocket, namer.getName());
    }

    game.createMap();

    for (int i = 0; i < try_num; i++) {
      ArrayList<Territory> res =
          (ArrayList<Territory>)communicate.receiveObject(socket_list.get(i));
      for (Territory t : res) {
        System.out.println(t.getName() + ": " + t.getUnitsNumber() + " units");
      }
    }
    //game.sendMapAll();
    //System.out.println();
  }
}
